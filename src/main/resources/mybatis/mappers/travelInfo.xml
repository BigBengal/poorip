<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="travelInfo">
	
    <!-- 사용자가 도시 선택시 도시에 있는 여행 정보 보여주기 -->
    <select id="getInfo" parameterType="integer" resultType="travelinfovo">
      <![CDATA[
         select 
         		trv_seq as trvSeq,
         		cat_seq as catSeq,
         		crt_date as crtDate,
         		name as name,
         		contents,
         		hours,
         		location,
         		picture,
         		price,
         		map_url as mapURL,
         		contact
		 from travel_info
		 where cty_seq = #{ctySeq }
      ]]>
	</select>
	
    <select id="getList" resultType="travelinfovo">
      <![CDATA[
         select 
         		trv_seq as trvSeq,
         		cat_seq as catSeq,
         		crt_date as crtDate,
         		name as name,
         		contents,
         		hours,
         		location,
         		picture,
         		price,
         		map_url as mapURL,
         		contact
		 from travel_info
      ]]>
	</select>
    
    <!-- 도시 정보 삭제를 위한 번호 가져오기 -->
    <select id="getByNo" parameterType="integer" resultType="travelinfovo">
      <![CDATA[
         select 
         		trv_seq as trvSeq,
         		cat_seq as catSeq,
         		crt_date as crtDate,
         		name as name,
         		contents,
         		hours,
         		location,
         		picture,
         		price,
         		map_url as mapURL,
         		contact
		 from travel_info
		 where trv_seq = #{trvSeq }
      ]]>
	</select>
	
	<!-- 선택하지 않았을때 메인 여행 정보 보여주기 -->
    <select id="getInfomain" resultType="travelinfovo">
      <![CDATA[
         select 
         		trv_seq as trvSeq,
         		cat_seq as catSeq,
         		crt_date as crtDate,
         		name as name,
         		contents,
         		hours,
         		location,
         		picture,
         		price,
         		map_url as mapURL,
         		contact
		 from travel_info
      ]]>
	</select>
	
    <!-- 여행정보 Seq, name 가져오기 -->
    <select id="getALLTravelInfo" resultType="travelinfovo">
      <![CDATA[
         select 
         		trv_seq as trvSeq,
         		name as name
		 from travel_info
      ]]>
	</select>
	
    <!-- 여행 정보 추가하기 -->
    <insert id="insert" parameterType="travelinfovo">
        <![CDATA[
         insert into travel_info
			values(null,
			       #{name },
			       #{contents },
			       #{hours },
			       #{location },
			       #{picture },
			       #{price },
			       now(),
			       #{ctySeq },
			       #{catSeq },
			       null,
			       #{contact },
			       null)
      ]]>
    </insert>
    
	<!-- 사용자가 스크랩한 정보 클릭시 보여주는 화면 출력 -->
	<select id="getScrapInfo" parameterType="string" resultType="scrapvo">
      <![CDATA[
         select travel_info.crt_date as crtDate,
         		travel_info.NAME as name,
         		travel_info.CONTENTS as contents,
         		hours,
         		location,
         		picture,
         		price,
         		map_url as mapURL,
         		contact 
					from scrap, travel_info 
		where scrap.TRV_SEQ=travel_info.TRV_SEQ
		AND scrap.usr_seq = #{usrSeq }
      ]]>
	</select>
	
	<!-- 여행 정보 삭제하기 -->
    <delete id="delete" parameterType="travelinfovo">
        <![CDATA[
         DELETE FROM travel_info WHERE trv_seq = #{trvSeq }
      ]]>
    </delete>
    
    <!-- 사용자가 입력한 자동완성 데이터 추출 -->
	<select id="getKwdData" parameterType="string" resultType="travelinfovo">
   		<![CDATA[
         select cty.CTY_SEQ as ctySeq, cty.CTY_NAME as name, ctr.CTR_NAME as contents
			from city cty, country ctr
		 where (cty.CTY_NAME like '%${_parameter}%'
		 or ctr.CTR_NAME like '%${_parameter}%')
		 and cty.CTR_SEQ = ctr.CTR_SEQ
    	]]>
	</select>
	
	<!-- 사용자가 입력한 키워드 입력 관련 데이터 추출 -->
	<select id="getCitySeq" parameterType="string" resultType="integer">
   		<![CDATA[
         select cty_seq as ctySeq from seach where cty_name = #{ctyName }
    	]]>
	</select>
</mapper>
