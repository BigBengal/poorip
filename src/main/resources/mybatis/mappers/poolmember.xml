<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="poolmember">

	<insert id="insert"  parameterType="poolmembervo">
		<![CDATA[
			insert 
			  into POOL_MEMBER (POOLMEM_SEQ, POOL_SEQ, USR_SEQ, APPROVE)
			values ( #{poolMemSeq }, #{poolSeq }, #{usrSeq }, #{approve } ) 
		]]>
	</insert>
	
	<select id="selectbyno" resultType="poolmembervo" parameterType="integer">
		<![CDATA[
			select POOLMEM_SEQ as poolMemSeq, 
			       POOL_SEQ as poolSeq, 
			       USR_SEQ as usrSeq, 
			       APPROVE as approve, 
			       CRT_DATE as crtDate
			  from POOL_MEMBER
			 where USR_SEQ = #{usrSeq }
		]]>
	</select>
	
	<delete id="delete" parameterType="poolmembervo">
		<![CDATA[
			DELETE 
			  FROM POOL_MEMBER
			 where POOL_SEQ = #{poolSeq }
		]]>
	</delete>
	
	<update id="approve" parameterType="poolmembervo">
		<![CDATA[
			UPDATE POOL_MEMBER
			   SET APPROVE = 'Y'
			 WHERE USR_SEQ  = #{usrSeq }
			   AND POOL_SEQ = #{poolSeq }
		]]>
	</update>
	
	<delete id="reject" parameterType="poolmembervo">
		<![CDATA[
			DELETE 
			  FROM POOL_MEMBER
			 WHERE USR_SEQ  = #{usrSeq }
			   AND POOL_SEQ = #{poolSeq }
			   AND APPROVE = 'N'
		]]>
	</delete>
	
	
	<select id="isdestorable" parameterType="poolmembervo">
		<![CDATA[
			select count(*)
			 from pool_party p, pool_member m                                 
			where p.POOL_SEQ = m.POOL_SEQ                                    
			  and p.MANAGER_USR_SEQ <> m.USR_SEQ                             
			  and m.approve = 'Y'                                            
			  and p.POOL_SEQ = #{poolSeq }                                            
		]]>
	</select>
	
	
	
	
</mapper>
