<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="poolparty">


	<!-- 풀 파티 추가 -->
	<insert id="insert"  parameterType="poolpartyvo">
		<![CDATA[
			insert into pool_party
			(POOL_SEQ, POOL_NAME,  POOL_COMMENT,  POOL_PIC,  CITY_SEQ,  MANAGER_EMAIL,  POOL_PUBLIC_YN)
			values
			(#{poolSeq }, #{poolName }, #{poolComment }, #{poolPic }, #{citySeq }, #{managerEmail }, #{poolPublicYn } )
		]]>
	</insert>
	
	<!-- 풀 파티 조회-->
	<select id="selectbyseq" resultType="poolpartyvo" parameterType="integer">
		<![CDATA[
			SELECT POOL_SEQ as poolSeq,
			       POOL_NAME as poolName,
			       POOL_COMMENT as poolComment,
			       POOL_PIC as poolPic,
			       CITY_SEQ as citySeq,
			       MANAGER_EMAIL as managerEmail,
			       POOL_PUBLIC_YN as poolPublic_yn,
			       CRT_DATE as crtDate
			  FROM POOL_PARTY
			 WHERE POOL_SEQ = #{string }
		]]>
	</select>
	
	<!-- 메인화면에서 도시이름/ 날짜로 풀파티 조회 -->
	<select id="selectbycty" resultType="poolpartyvo" parameterType="poolpartyvo">
		<![CDATA[
	 SELECT pool_seq as poolSeq, 
	 	    pool_name as poolName, 
	 	    pool_comment as poolComment, 
	 	    pool_pic as poolPic, 
	 	    manager_email as managerEmail, 
 		    pool_public_yn as poolPublicYn, 
 		    from_date as fromDate, 
 		    to_date as toDate 
 		FROM pool_party, city
 		WHERE `from_date` 
 		BETWEEN str_to_date(#{fromDate}, '%c/%e/%Y') 
 		AND DATE_sub(str_to_date(#{toDate}, '%c/%e/%Y'), INTERVAL 1 day) 
 		AND city.cty_name like '%${ctyName}%'
 		AND city.cty_seq = pool_party.cty_seq
 		AND pool_public_yn="Y"
	]]>
	</select>
	
	<!-- 풀 파티 변경-->
	<select id="update" parameterType="poolpartyvo">
		<![CDATA[
			UPDATE POOL_PARTY
			   SET POOL_NAME = #{poolName }
			]]>
			<if test="poolComment != null">
			   <![CDATA[
			   	,POOL_COMMENT  = #{poolComment }
			   ]]>
			</if>
			<if test="poolPic != null">
			   <![CDATA[
			   	,POOL_PIC  = #{poolPic }
			   ]]>
			</if>
			<if test="citySeq != null">
			   <![CDATA[
			   	,CITY_SEQ  = #{citySeq }
			   ]]>
			</if>  
			<if test="managerEmail != null">
			   <![CDATA[
			   	,MANAGER_EMAIL  = #{managerEmail }
			   ]]>
			</if>    
			 <if test="poolPublic_yn != null">
			   <![CDATA[
			   	,POOL_PUBLIC_YN  = #{poolPublic_yn }
			   ]]>
			</if> 
			<![CDATA[ 
			WHERE POOL_SEQ = #{poolSeq }
		]]>
	</select>
	
	<!-- 풀 파티 삭제 -->
	<delete id="delete" parameterType="poolpartyvo">
		<![CDATA[
			delete 
			  from POOL_PARTY
			 where POOL_SEQ = #{poolSeq }
		]]>
		
	
	</delete>
	
</mapper>
